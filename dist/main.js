/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={"./src/scss/base.scss":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://bookshop/./src/scss/base.scss?")},"./src/app.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scss_base_scss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scss/base.scss */ "./src/scss/base.scss");\n/* harmony import */ var _js_request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./js/request.js */ "./src/js/request.js");\n/* harmony import */ var _js_categories_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./js/categories.js */ "./src/js/categories.js");\n/* harmony import */ var _js_cart_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./js/cart.js */ "./src/js/cart.js");\n\n\n\n\n\n\n//# sourceURL=webpack://bookshop/./src/app.js?')},"./src/js/cart.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"initCartButtons\": () => (/* binding */ initCartButtons)\n/* harmony export */ });\nconst cartHeader = document.getElementById('books-in-cart');\n\nfunction getLocalsStorage() {\n    const data = JSON.parse(localStorage.getItem('booksInCart'));\n    return data ? data : [];\n}\n\nfunction setLocalsStorage(data) {\n    localStorage.setItem('booksInCart', JSON.stringify(data));\n}\n\nfunction initCartButtons() {\n    const addCardButtons = document.querySelectorAll('#add-remove-cart');\n    console.log(localStorage);\n\n    if (getLocalsStorage().length == 0) {\n        setLocalsStorage(new Array());\n    }\n\n    addCardButtons.forEach(button => {\n        const currentBookId = button.closest('.book-item').dataset.index;\n        let checkBookInCard = false;\n        let booksInCart = getLocalsStorage();\n        console.log(booksInCart);\n        if (booksInCart.length > 0) {\n            booksInCart.forEach(element => {\n                if (element == currentBookId) checkBookInCard = true;\n            });\n\n            if (checkBookInCard) {\n                button.classList.add('remove-cart-button');\n                button.textContent = 'in the cart';\n            }\n        }\n\n        button.addEventListener('click', (e) => {\n\n            const currentBookId = e.target.closest('.book-item').dataset.index;\n\n            let checkBookInCard = false;\n            let booksInCart = getLocalsStorage();\n            booksInCart.forEach(element => {\n                if (element == currentBookId) checkBookInCard = true;\n            });\n\n            if (checkBookInCard) {\n\n                console.log('---------');\n                console.log('   ' + booksInCart);\n\n                let index = booksInCart.indexOf(currentBookId);\n                booksInCart.splice(index, 1);\n\n                console.log('   ' + booksInCart);\n                setLocalsStorage(booksInCart);\n                console.log('---------');\n\n                e.target.classList.remove('remove-cart-button');\n                button.textContent = 'buy now';\n\n                reloadCartHeader();\n\n                console.log('remove');\n                console.log(localStorage);\n            } else {\n                booksInCart.push(currentBookId);\n                setLocalsStorage(booksInCart);\n\n                e.target.classList.add('remove-cart-button');\n                button.textContent = 'in the cart';\n\n                reloadCartHeader();\n\n                console.log('add');\n                console.log(localStorage);\n\n            }\n\n        });\n    });\n}\n\nfunction reloadCartHeader() {\n    const booksInCartCount = getLocalsStorage().length;\n    if (booksInCartCount == 0) cartHeader.style.display = 'none';\n    else cartHeader.style.display = 'flex';\n    cartHeader.textContent = booksInCartCount;\n}\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    reloadCartHeader();\n});\n\n//# sourceURL=webpack://bookshop/./src/js/cart.js?")},"./src/js/categories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./request.js */ \"./src/js/request.js\");\n\n\nconst categoriesData = [{\n        name: 'Architecture',\n        subject: 'Architecture'\n\n    },\n    {\n        name: 'Art & Fashion',\n        subject: 'Art'\n    },\n    {\n        name: 'Biography',\n        subject: 'Biography & Autobiography'\n    },\n    {\n        name: 'Business',\n        subject: 'Business'\n    },\n    {\n        name: 'Crafts & Hobbies',\n        subject: 'Crafts & Hobbies'\n    },\n    {\n        name: 'Drama',\n        subject: 'Drama'\n    },\n    {\n        name: 'Fiction',\n        subject: 'Fiction'\n    },\n    {\n        name: 'Food & Drink',\n        subject: 'Cooking'\n    },\n    {\n        name: 'Health & Wellbeing',\n        subject: 'Health & Fitness'\n    },\n    {\n        name: 'History & Politics',\n        subject: 'History',\n    },\n    {\n        name: 'Humor',\n        subject: 'Humor'\n    },\n    {\n        name: 'Poetry',\n        subject: 'Poetry'\n    },\n    {\n        name: 'Psychology',\n        subject: 'Psychology'\n    },\n    {\n        name: 'Science',\n        subject: 'Science'\n    },\n    {\n        name: 'Technology',\n        subject: 'Technology'\n    },\n    {\n        name: 'Travel & Maps',\n        subject: 'Travel'\n    }\n];\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const categoriesListElement = document.getElementById('categories');\n    categoriesData.forEach((item, index) => {\n        let listElement = document.createElement('li');\n        if (index == 0) {\n            listElement.classList.add('active');\n        }\n        let buttonElement = document.createElement('button');\n        buttonElement.textContent = item.name;\n        buttonElement.dataset.index = index;\n        \n        buttonElement.addEventListener('click', (event) => {\n            (0,_request_js__WEBPACK_IMPORTED_MODULE_0__.request)(item.subject);\n\n            categoriesListElement.querySelector('.active').classList.remove('active');\n            console.log(event.target);\n            console.log(event.target.closest('li'));\n            event.target.closest('li').classList.add('active');\n        });\n\n        listElement.appendChild(buttonElement);\n        categoriesListElement.appendChild(listElement);\n    });\n});\n\n//# sourceURL=webpack://bookshop/./src/js/categories.js?")},"./src/js/request.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "request": () => (/* binding */ request)\n/* harmony export */ });\n/* harmony import */ var _tools_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tools.js */ "./src/js/tools.js");\n/* harmony import */ var _cart_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cart.js */ "./src/js/cart.js");\n\n\n\nfunction url(key, subject) {\n    return `https://www.googleapis.com/books/v1/volumes?q="subject:${subject}"&key=${key}&printType=books&startIndex=0&maxResults=6&langRestrict=en`;\n}\nconst key = \'AIzaSyDQUaZUwEvbjQxO8awYggZPzgolT9-YNAw\';\nconst catalog = document.getElementById(\'catalog\');\n\nconst spinnerElement = `\n<div class="catalog-spinner-block" id="spinner">\n    <svg class="catalog-spinner" viewBox="0 0 50 50">\n        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>\n    </svg>\n</div>\n`;\n\nfunction createBook(bookInfo) {\n    const bookId = bookInfo.id;\n    bookInfo = bookInfo.volumeInfo;\n\n    let cover = \'\';\n    if (bookInfo.imageLinks && bookInfo.imageLinks.thumbnail) cover = `<img class="cover" src="${bookInfo.imageLinks.thumbnail}" alt="Book cover">`;\n    else cover = \'<div class="no-cover">The cover is missing</div>\';\n\n    let rating = \'\';\n    if (bookInfo.averageRating) {\n        rating = `${_tools_js__WEBPACK_IMPORTED_MODULE_0__.ratingStars(bookInfo.averageRating)} <span>${bookInfo.ratingsCount} review</span>`;\n    } else rating = \'<span>There is no rating</span>\';\n\n    let price = \'\';\n    if (bookInfo.saleInfo && bookInfo.saleInfo.retailPrice) {\n        price = `<span class="price">${_tools_js__WEBPACK_IMPORTED_MODULE_0__["getСurrency"](bookInfo.saleInfo.retailPrice.currencyCode)}${toString(bookInfo.saleInfo.retailPrice.amount)}</span>`;\n    } else price = \'<span class="price-not">Price not specified</span>\';\n\n    return `\n    <div class="book-item" data-index="${bookId}">\n        ${cover}\n        <div class="info">\n            <span class="author">${bookInfo.authors ? bookInfo.authors : \'Unknown author\'}</span>\n            <span class="title">${bookInfo.title ? bookInfo.title : \'Unknown book name\'}</span>\n            <div class="rating">${rating}</div>\n            <span class="description">${bookInfo.description ? bookInfo.description : \'Unknown description\'}</span>\n            ${price}\n            <button class="catalog-button" id="add-remove-cart">buy now</button>\n        </div>\n    </div>`;\n}\n\nfunction request(subject) {\n    catalog.innerHTML = spinnerElement;\n    fetch(url(key, subject))\n        .then((response) => { return response.json(); })\n        .then((data) => {\n            catalog.removeChild(document.getElementById(\'spinner\'));\n            render(data.items);\n        })\n        .catch((error) => { console.log(\'error: \' + error); });\n\n    function render(data) {\n        const length = Object.keys(data).length;\n        console.log(data);\n        console.log(\'length: \' + length);\n        let books = \'\';\n        data.forEach((item, index) => {\n            if (index < 3) {\n                books += createBook(item);\n            }\n        });\n\n        catalog.innerHTML += books;\n\n\n\n        if (length > 3) {\n\n            let loadButton = document.createElement(\'button\');\n            loadButton.classList.add(\'catalog-button\');\n            loadButton.addEventListener(\'click\', (event) => {\n                event.target.parentElement.parentElement.removeChild(event.target.parentElement);\n                render(data.splice(3));\n            });\n            let loadButtonBlock = document.createElement(\'div\');\n            loadButtonBlock.classList.add(\'load-block\');\n            loadButton.textContent = \'Load more\';\n            loadButtonBlock.appendChild(loadButton);\n            catalog.appendChild(loadButtonBlock);\n        }\n\n        (0,_cart_js__WEBPACK_IMPORTED_MODULE_1__.initCartButtons)();\n    }\n}\n\n\ndocument.addEventListener(\'DOMContentLoaded\', () => {\n    request(\'Travel\');\n});\n\n//# sourceURL=webpack://bookshop/./src/js/request.js?')},"./src/js/tools.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "getСurrency": () => (/* binding */ getСurrency),\n/* harmony export */   "ratingStars": () => (/* binding */ ratingStars)\n/* harmony export */ });\nfunction getСurrency(code) {\n    switch (code) {\n        case \'RUB\':\n            return \'₽\';\n        default:\n            return code;\n\n    }\n}\n\nfunction ratingStars(rating) {\n    const star = \'./src/images/icons/star.svg\';\n    const starHalfFill = \'./src/images/icons/star_half_fill.svg\';\n    const starFill = \'./src/images/icons/star_fill.svg\';\n\n    let starsCount = 0;\n    let result = \'\';\n\n    for (let i = 0; i < Math.trunc(rating); i++) {\n        result += `<img src="${starFill}" alt="Rating star">`;\n        starsCount++;\n    }\n\n    if (starsCount == 5) return result;\n\n    if (rating % 1 > 0) {\n        result += `<img src="${starHalfFill}" alt="Rating star">`;\n        starsCount++;\n        if (starsCount == 5) return result;\n    }\n\n    for (let i = starsCount; i < 5; i++) {\n        result += `<img src="${star}" alt="Rating star">`;\n        starsCount++;\n    }\n    return result;\n}\n\n//# sourceURL=webpack://bookshop/./src/js/tools.js?')}},__webpack_module_cache__={};function __webpack_require__(n){var e=__webpack_module_cache__[n];if(void 0!==e)return e.exports;var t=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(n,e)=>{for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),__webpack_require__.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/app.js")})();