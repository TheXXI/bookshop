/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={"./src/scss/base.scss":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://bookshop/./src/scss/base.scss?")},"./src/app.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scss_base_scss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scss/base.scss */ "./src/scss/base.scss");\n/* harmony import */ var _js_request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./js/request.js */ "./src/js/request.js");\n/* harmony import */ var _js_categories_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./js/categories.js */ "./src/js/categories.js");\n/* harmony import */ var _js_cart_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./js/cart.js */ "./src/js/cart.js");\n\r\n\r\n//import \'./js/slider.js\';\r\n\r\n\r\n\r\n\n\n//# sourceURL=webpack://bookshop/./src/app.js?')},"./src/js/cart.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"initCartButtons\": () => (/* binding */ initCartButtons)\n/* harmony export */ });\nconst cartHeader = document.getElementById('books-in-cart');\r\n\r\nfunction getLocalsStorage() {\r\n    const data = JSON.parse(localStorage.getItem('booksInCart'));\r\n    return data ? data : [];\r\n}\r\n\r\nfunction setLocalsStorage(data) {\r\n    localStorage.setItem('booksInCart', JSON.stringify(data));\r\n}\r\n\r\nfunction initCartButtons() {\r\n    const addCardButtons = document.querySelectorAll('#add-remove-cart');\r\n    console.log(localStorage);\r\n\r\n    if (getLocalsStorage().length == 0) {\r\n        setLocalsStorage(new Array());\r\n    }\r\n\r\n    addCardButtons.forEach(button => {\r\n        const currentBookId = button.closest('.book-item').dataset.index;\r\n        let checkBookInCard = false;\r\n        let booksInCart = getLocalsStorage();\r\n        console.log(booksInCart);\r\n        if (booksInCart.length > 0) {\r\n            booksInCart.forEach(element => {\r\n                if (element == currentBookId) checkBookInCard = true;\r\n            });\r\n\r\n            if (checkBookInCard) {\r\n                button.classList.add('remove-cart-button');\r\n                button.textContent = 'in the cart';\r\n            }\r\n        }\r\n\r\n        button.addEventListener('click', (e) => {\r\n\r\n            const currentBookId = e.target.closest('.book-item').dataset.index;\r\n\r\n            let checkBookInCard = false;\r\n            let booksInCart = getLocalsStorage();\r\n            booksInCart.forEach(element => {\r\n                if (element == currentBookId) checkBookInCard = true;\r\n            });\r\n\r\n            if (checkBookInCard) {\r\n\r\n                console.log('---------');\r\n                console.log('   ' + booksInCart);\r\n\r\n                let index = booksInCart.indexOf(currentBookId);\r\n                booksInCart.splice(index, 1);\r\n\r\n                console.log('   ' + booksInCart);\r\n                setLocalsStorage(booksInCart);\r\n                console.log('---------');\r\n\r\n                e.target.classList.remove('remove-cart-button');\r\n                button.textContent = 'buy now';\r\n\r\n                reloadCartHeader();\r\n\r\n                console.log('remove');\r\n                console.log(localStorage);\r\n            } else {\r\n                booksInCart.push(currentBookId);\r\n                setLocalsStorage(booksInCart);\r\n\r\n                e.target.classList.add('remove-cart-button');\r\n                button.textContent = 'in the cart';\r\n\r\n                reloadCartHeader();\r\n\r\n                console.log('add');\r\n                console.log(localStorage);\r\n\r\n            }\r\n\r\n        });\r\n    });\r\n}\r\n\r\nfunction reloadCartHeader() {\r\n    const booksInCartCount = getLocalsStorage().length;\r\n    if (booksInCartCount == 0) cartHeader.style.display = 'none';\r\n    else cartHeader.style.display = 'flex';\r\n    cartHeader.textContent = booksInCartCount;\r\n}\r\n\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    reloadCartHeader();\r\n});\n\n//# sourceURL=webpack://bookshop/./src/js/cart.js?")},"./src/js/categories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./request.js */ \"./src/js/request.js\");\n\r\n\r\nconst categoriesData = [{\r\n        name: 'Architecture',\r\n        subject: 'Architecture'\r\n\r\n    },\r\n    {\r\n        name: 'Art & Fashion',\r\n        subject: 'Art'\r\n    },\r\n    {\r\n        name: 'Biography',\r\n        subject: 'Biography & Autobiography'\r\n    },\r\n    {\r\n        name: 'Business',\r\n        subject: 'Business'\r\n    },\r\n    {\r\n        name: 'Crafts & Hobbies',\r\n        subject: 'Crafts & Hobbies'\r\n    },\r\n    {\r\n        name: 'Drama',\r\n        subject: 'Drama'\r\n    },\r\n    {\r\n        name: 'Fiction',\r\n        subject: 'Fiction'\r\n    },\r\n    {\r\n        name: 'Food & Drink',\r\n        subject: 'Cooking'\r\n    },\r\n    {\r\n        name: 'Health & Wellbeing',\r\n        subject: 'Health & Fitness'\r\n    },\r\n    {\r\n        name: 'History & Politics',\r\n        subject: 'History',\r\n    },\r\n    {\r\n        name: 'Humor',\r\n        subject: 'Humor'\r\n    },\r\n    {\r\n        name: 'Poetry',\r\n        subject: 'Poetry'\r\n    },\r\n    {\r\n        name: 'Psychology',\r\n        subject: 'Psychology'\r\n    },\r\n    {\r\n        name: 'Science',\r\n        subject: 'Science'\r\n    },\r\n    {\r\n        name: 'Technology',\r\n        subject: 'Technology'\r\n    },\r\n    {\r\n        name: 'Travel & Maps',\r\n        subject: 'Travel'\r\n    }\r\n];\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    const categoriesListElement = document.getElementById('categories');\r\n    categoriesData.forEach((item, index) => {\r\n        let listElement = document.createElement('li');\r\n        if (index == 0) {\r\n            listElement.classList.add('active');\r\n        }\r\n        let buttonElement = document.createElement('button');\r\n        buttonElement.textContent = item.name;\r\n        buttonElement.dataset.index = index;\r\n        \r\n        buttonElement.addEventListener('click', (event) => {\r\n            (0,_request_js__WEBPACK_IMPORTED_MODULE_0__.request)(item.subject);\r\n\r\n            categoriesListElement.querySelector('.active').classList.remove('active');\r\n            console.log(event.target);\r\n            console.log(event.target.closest('li'));\r\n            event.target.closest('li').classList.add('active');\r\n        });\r\n\r\n        listElement.appendChild(buttonElement);\r\n        categoriesListElement.appendChild(listElement);\r\n    });\r\n});\n\n//# sourceURL=webpack://bookshop/./src/js/categories.js?")},"./src/js/request.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "request": () => (/* binding */ request)\n/* harmony export */ });\n/* harmony import */ var _tools_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tools.js */ "./src/js/tools.js");\n/* harmony import */ var _cart_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cart.js */ "./src/js/cart.js");\n\r\n\r\n\r\nfunction url(key, subject) {\r\n    return `https://www.googleapis.com/books/v1/volumes?q="subject:${subject}"&key=${key}&printType=books&startIndex=0&maxResults=6&langRestrict=en`;\r\n}\r\nconst key = \'AIzaSyDQUaZUwEvbjQxO8awYggZPzgolT9-YNAw\';\r\nconst catalog = document.getElementById(\'catalog\');\r\n\r\nconst spinnerElement = `\r\n<div class="catalog-spinner-block" id="spinner">\r\n    <svg class="catalog-spinner" viewBox="0 0 50 50">\r\n        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>\r\n    </svg>\r\n</div>\r\n`;\r\n\r\nfunction createBook(bookInfo) {\r\n    const bookId = bookInfo.id;\r\n    bookInfo = bookInfo.volumeInfo;\r\n\r\n    let cover = \'\';\r\n    if (bookInfo.imageLinks && bookInfo.imageLinks.thumbnail) cover = `<img class="cover" src="${bookInfo.imageLinks.thumbnail}" alt="Book cover">`;\r\n    else cover = \'<div class="no-cover">The cover is missing</div>\';\r\n\r\n    let rating = \'\';\r\n    if (bookInfo.averageRating) {\r\n        rating = `${_tools_js__WEBPACK_IMPORTED_MODULE_0__.ratingStars(bookInfo.averageRating)} <span>${bookInfo.ratingsCount} review</span>`;\r\n    } else rating = \'<span>There is no rating</span>\';\r\n\r\n    let price = \'\';\r\n    if (bookInfo.saleInfo && bookInfo.saleInfo.retailPrice) {\r\n        price = `<span class="price">${_tools_js__WEBPACK_IMPORTED_MODULE_0__["getСurrency"](bookInfo.saleInfo.retailPrice.currencyCode)}${toString(bookInfo.saleInfo.retailPrice.amount)}</span>`;\r\n    } else price = \'<span class="price-not">Price not specified</span>\';\r\n\r\n    return `\r\n    <div class="book-item" data-index="${bookId}">\r\n        ${cover}\r\n        <div class="info">\r\n            <span class="author">${bookInfo.authors ? bookInfo.authors : \'Unknown author\'}</span>\r\n            <span class="title">${bookInfo.title ? bookInfo.title : \'Unknown book name\'}</span>\r\n            <div class="rating">${rating}</div>\r\n            <span class="description">${bookInfo.description ? bookInfo.description : \'Unknown description\'}</span>\r\n            ${price}\r\n            <button class="catalog-button" id="add-remove-cart">buy now</button>\r\n        </div>\r\n    </div>`;\r\n}\r\n\r\nfunction request(subject = \'Architecture\') {\r\n    catalog.innerHTML = spinnerElement;\r\n    fetch(url(key, subject))\r\n        .then((response) => { return response.json(); })\r\n        .then((data) => {\r\n            catalog.removeChild(document.getElementById(\'spinner\'));\r\n            render(data.items);\r\n        })\r\n        .catch((error) => { console.log(\'error: \' + error); });\r\n\r\n    function render(data) {\r\n        const length = Object.keys(data).length;\r\n        console.log(data);\r\n        console.log(\'length: \' + length);\r\n        let books = \'\';\r\n        data.forEach((item, index) => {\r\n            if (index < 3) {\r\n                books += createBook(item);\r\n            }\r\n        });\r\n\r\n        catalog.innerHTML += books;\r\n\r\n\r\n\r\n        if (length > 3) {\r\n\r\n            let loadButton = document.createElement(\'button\');\r\n            loadButton.classList.add(\'catalog-button\');\r\n            loadButton.addEventListener(\'click\', (event) => {\r\n                event.target.parentElement.parentElement.removeChild(event.target.parentElement);\r\n                render(data.splice(3));\r\n            });\r\n            let loadButtonBlock = document.createElement(\'div\');\r\n            loadButtonBlock.classList.add(\'load-block\');\r\n            loadButton.textContent = \'Load more\';\r\n            loadButtonBlock.appendChild(loadButton);\r\n            catalog.appendChild(loadButtonBlock);\r\n        }\r\n\r\n        (0,_cart_js__WEBPACK_IMPORTED_MODULE_1__.initCartButtons)();\r\n    }\r\n}\r\n\r\n\r\ndocument.addEventListener(\'DOMContentLoaded\', () => {\r\n    request();\r\n});\n\n//# sourceURL=webpack://bookshop/./src/js/request.js?')},"./src/js/tools.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "getСurrency": () => (/* binding */ getСurrency),\n/* harmony export */   "ratingStars": () => (/* binding */ ratingStars)\n/* harmony export */ });\nfunction getСurrency(code) {\r\n    switch (code) {\r\n        case \'RUB\':\r\n            return \'₽\';\r\n        default:\r\n            return code;\r\n\r\n    }\r\n}\r\n\r\nfunction ratingStars(rating) {\r\n    const star = \'./src/images/icons/star.svg\';\r\n    const starHalfFill = \'./src/images/icons/star_half_fill.svg\';\r\n    const starFill = \'./src/images/icons/star_fill.svg\';\r\n\r\n    let starsCount = 0;\r\n    let result = \'\';\r\n\r\n    for (let i = 0; i < Math.trunc(rating); i++) {\r\n        result += `<img src="${starFill}" alt="Rating star">`;\r\n        starsCount++;\r\n    }\r\n\r\n    if (starsCount == 5) return result;\r\n\r\n    if (rating % 1 > 0) {\r\n        result += `<img src="${starHalfFill}" alt="Rating star">`;\r\n        starsCount++;\r\n        if (starsCount == 5) return result;\r\n    }\r\n\r\n    for (let i = starsCount; i < 5; i++) {\r\n        result += `<img src="${star}" alt="Rating star">`;\r\n        starsCount++;\r\n    }\r\n    return result;\r\n}\n\n//# sourceURL=webpack://bookshop/./src/js/tools.js?')}},__webpack_module_cache__={};function __webpack_require__(r){var n=__webpack_module_cache__[r];if(void 0!==n)return n.exports;var e=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(r,n)=>{for(var e in n)__webpack_require__.o(n,e)&&!__webpack_require__.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:n[e]})},__webpack_require__.o=(r,n)=>Object.prototype.hasOwnProperty.call(r,n),__webpack_require__.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/app.js")})();